USE lab7_java5;

-- üß± B·∫£ng danh m·ª•c
CREATE TABLE Category (
    id INT PRIMARY KEY,
    name NVARCHAR(100)
);

-- üì¶ B·∫£ng s·∫£n ph·∫©m (TH√äM M·ªöI)
CREATE TABLE Product (
    Id INT PRIMARY KEY,
    Name NVARCHAR(255),
    Price DECIMAL(10,2),
    Date DATE
);

-- üîó B·∫£ng li√™n k·∫øt danh m·ª•c - s·∫£n ph·∫©m
CREATE TABLE Category_Product (
    ctid INT NOT NULL,
    pdid INT NOT NULL,
    PRIMARY KEY (ctid, pdid),
    FOREIGN KEY (ctid) REFERENCES Category(id),
    FOREIGN KEY (pdid) REFERENCES Product(Id)
);

-- üìã D·ªØ li·ªáu Category
INSERT INTO Category (id, name) VALUES
(101, N'ƒê·ªì u·ªëng & C√† ph√™'),
(102, N'B√°nh k·∫πo & ƒê·ªì ng·ªçt'),
(103, N'S·ªØa & S·∫£n ph·∫©m t·ª´ s·ªØa'),
(104, N'Gia v·ªã & ƒê∆∞·ªùng mu·ªëi'),
(105, N'Ng≈© c·ªëc & B√°nh m√¨'),
(106, N'S·∫£n ph·∫©m t·ª´ m·∫≠t ong & siro'),
(107, N'Th·ª±c ph·∫©m t·ª± nhi√™n & h·ªØu c∆°');

-- üì¶ D·ªØ li·ªáu Product (TH√äM M·ªöI)
INSERT INTO Product (Id, Name, Price, Date) VALUES
(1001, N'C√† ph√™ ƒëen', 25000, '2024-01-15'),
(1002, N'B√°nh quy socola', 15000, '2024-01-16'),
(1003, N'Rau h·ªØu c∆°', 30000, '2024-01-17'),
(1004, N'Tr√°i c√¢y t∆∞∆°i', 45000, '2024-01-18'),
(1005, N'S·ªØa t∆∞∆°i', 20000, '2024-01-19'),
(1006, N'Tr√† xanh', 18000, '2024-01-20'),
(1007, N'Ph√¥ mai', 35000, '2024-01-21'),
(1008, N'M·∫≠t ong nguy√™n ch·∫•t', 40000, '2024-01-22'),
(1009, N'H·∫°t dinh d∆∞·ª°ng', 55000, '2024-01-23'),
(1010, N'B√°nh m√¨ nguy√™n c√°m', 12000, '2024-01-24'),
(1011, N'N∆∞·ªõc √©p cam', 22000, '2024-01-25'),
(1012, N'D·∫ßu olive', 60000, '2024-01-26'),
(1013, N'C√† ph√™ s·ªØa', 28000, '2024-01-27'),
(1014, N'N∆∞·ªõc kho√°ng', 8000, '2024-01-28'),
(1015, N'K·∫πo d·∫ªo', 10000, '2024-01-29'),
(1016, N'Mu·ªëi bi·ªÉn', 5000, '2024-01-30'),
(1017, N'Ti√™u ƒëen', 25000, '2024-02-01'),
(1018, N'G·∫°o l·ª©t', 30000, '2024-02-02'),
(1019, N'B√°nh kem', 35000, '2024-02-03'),
(1020, N'S·ªØa chua', 15000, '2024-02-04'),
(1021, N'K·∫πo cao su', 8000, '2024-02-05'),
(1022, N'ƒê∆∞·ªùng n√¢u', 12000, '2024-02-06'),
(1023, N'B√°nh quy gi√≤n', 18000, '2024-02-07'),
(1024, N'ƒê∆∞·ªùng tr·∫Øng', 10000, '2024-02-08'),
(1025, N'B·ªôt n√™m', 15000, '2024-02-09'),
(1026, N'B∆°', 25000, '2024-02-10'),
(1027, N'N∆∞·ªõc ng·ªçt', 12000, '2024-02-11'),
(1028, N'Rau c·ªß h·ªØu c∆°', 28000, '2024-02-12'),
(1029, N'B√°nh ng·ªçt', 20000, '2024-02-13'),
(1030, N'B√°nh m√¨ sandwich', 10000, '2024-02-14'),
(1031, N'K·∫πo socola', 18000, '2024-02-15'),
(1032, N'S·ªØa ƒë·∫∑c', 22000, '2024-02-16'),
(1033, N'Kem t∆∞∆°i', 30000, '2024-02-17'),
(1034, N'S·ªØa b·ªôt', 40000, '2024-02-18'),
(1035, N'B√°nh m√¨ ng·ªçt', 14000, '2024-02-19'),
(1036, N'H·∫°t chia', 50000, '2024-02-20'),
(1037, N'Ph√¥ mai kem', 32000, '2024-02-21'),
(1038, N'S·ªØa chua Hy L·∫°p', 25000, '2024-02-22'),
(1039, N'N∆∞·ªõc √©p t√°o', 20000, '2024-02-23'),
(1040, N'B∆° ƒë·∫≠u ph·ªông', 35000, '2024-02-24'),
(1041, N'Ng≈© c·ªëc', 25000, '2024-02-25'),
(1042, N'T∆∞∆°ng ·ªõt', 8000, '2024-02-26'),
(1043, N'N∆∞·ªõc m·∫Øm', 12000, '2024-02-27'),
(1044, N'N∆∞·ªõc chanh', 15000, '2024-02-28'),
(1045, N'Siro phong', 30000, '2024-03-01'),
(1046, N'Gi·∫•m', 10000, '2024-03-02'),
(1047, N'M·∫≠t ong hoa', 35000, '2024-03-03'),
(1048, N'H·∫°t h·∫°nh nh√¢n', 60000, '2024-03-04'),
(1049, N'B√°nh m√¨ ƒëen', 16000, '2024-03-05'),
(1050, N'B√°nh m√¨ tr·∫Øng', 12000, '2024-03-06'),
(1051, N'B√°nh m√¨ n√¢u', 14000, '2024-03-07'),
(1052, N'B√°nh m√¨ ng≈© c·ªëc', 18000, '2024-03-08'),
(1053, N'N∆∞·ªõc √©p nho', 25000, '2024-03-09'),
(1054, N'Siro agave', 40000, '2024-03-10'),
(1055, N'B√°nh kem d√¢u', 40000, '2024-03-11'),
(1056, N'H·∫°t √≥c ch√≥', 70000, '2024-03-12'),
(1057, N'M·∫≠t ong manuka', 80000, '2024-03-13'),
(1058, N'Siro c√¢y phong', 35000, '2024-03-14'),
(1059, N'M·∫≠t ong hoa c√∫c', 30000, '2024-03-15'),
(1060, N'S·ªØa h·∫°nh nh√¢n', 30000, '2024-03-16'),
(1061, N'G·∫°o n√¢u', 25000, '2024-03-17'),
(1062, N'H·∫°t quinoa', 80000, '2024-03-18'),
(1063, N'H·∫°t di√™m m·∫°ch', 90000, '2024-03-19'),
(1064, N'Mu·ªëi Himalaya', 20000, '2024-03-20'),
(1065, N'H·∫°t lanh', 45000, '2024-03-21'),
(1066, N'S·ªØa d·ª´a', 25000, '2024-03-22'),
(1067, N'H·∫°t b√≠', 35000, '2024-03-23'),
(1068, N'Tr√† ƒëen', 15000, '2024-03-24'),
(1069, N'H·∫°t h∆∞·ªõng d∆∞∆°ng', 20000, '2024-03-25'),
(1070, N'N∆∞·ªõc √©p d·ª©a', 22000, '2024-03-26'),
(1071, N'C√† ph√™ latte', 30000, '2024-03-27'),
(1072, N'Tr√† oolong', 20000, '2024-03-28'),
(1073, N'K·∫πo m·∫≠t ong', 18000, '2024-03-29'),
(1074, N'B√°nh m√¨ y·∫øn m·∫°ch', 16000, '2024-03-30'),
(1075, N'N∆∞·ªõc √©p c√† r·ªët', 18000, '2024-03-31'),
(1076, N'Siro hoa c√∫c', 25000, '2024-04-01'),
(1077, N'C√† ph√™ mocha', 32000, '2024-04-02'),
(1078, N'B√°nh kem vani', 38000, '2024-04-03'),
(1079, N'N∆∞·ªõc √©p xo√†i', 25000, '2024-04-04'),
(1080, N'B√°nh m√¨ h·∫°t', 20000, '2024-04-05'),
(1081, N'K·∫πo caramen', 15000, '2024-04-06'),
(1082, N'B·ªôt ng·ªçt', 8000, '2024-04-07'),
(1083, N'Siro g·ª´ng', 30000, '2024-04-08'),
(1084, N'M·∫≠t ong hoa nh√£n', 35000, '2024-04-09'),
(1085, N'N∆∞·ªõc √©p l√™', 20000, '2024-04-10'),
(1086, N'B·ªôt ngh·ªá', 25000, '2024-04-11'),
(1087, N'C√† ph√™ espresso', 28000, '2024-04-12'),
(1088, N'N∆∞·ªõc √©p d∆∞a h·∫•u', 18000, '2024-04-13'),
(1089, N'B√°nh kem socola', 42000, '2024-04-14'),
(1090, N'Siro hoa h·ªìng', 40000, '2024-04-15'),
(1091, N'K·∫πo b·∫°c h√†', 12000, '2024-04-16'),
(1092, N'M·∫≠t ong hoa c√† ph√™', 40000, '2024-04-17'),
(1093, N'B·ªôt t·ªèi', 15000, '2024-04-18'),
(1094, N'Siro hoa lavender', 45000, '2024-04-19'),
(1095, N'B·ªôt h√†nh', 12000, '2024-04-20'),
(1096, N'C√† ph√™ cappuccino', 30000, '2024-04-21'),
(1097, N'S·ªØa ƒë·∫≠u n√†nh', 22000, '2024-04-22'),
(1098, N'N∆∞·ªõc √©p kiwi', 30000, '2024-04-23'),
(1099, N'B√°nh m√¨ b√≠ ƒë·ªè', 18000, '2024-04-24'),
(1100, N'K·∫πo d√¢u t√¢y', 16000, '2024-04-25');

-- üîó D·ªØ li·ªáu b·∫£ng li√™n k·∫øt Category_Product
INSERT INTO Category_Product (ctid, pdid) VALUES
-- Category 101: ƒê·ªì u·ªëng & C√† ph√™
(101, 1001), (101, 1006), (101, 1010), (101, 1027), (101, 1044),
(101, 1068), (101, 1072), (101, 1077), (101, 1087), (101, 1096),
(101, 1011), (101, 1013), (101, 1014), (101, 1071),

-- Category 102: B√°nh k·∫πo & ƒê·ªì ng·ªçt
(102, 1002), (102, 1015), (102, 1029), (102, 1035), (102, 1055),
(102, 1078), (102, 1091), (102, 1100), (102, 1071), (102, 1081),
(102, 1019), (102, 1021), (102, 1024), (102, 1031), (102, 1073),

-- Category 103: S·ªØa & S·∫£n ph·∫©m t·ª´ s·ªØa
(103, 1007), (103, 1005), (103, 1033), (103, 1066), (103, 1097),
(103, 1034), (103, 1026), (103, 1035), (103, 1020), (103, 1060),
(103, 1032), (103, 1037), (103, 1038), (103, 1040),

-- Category 104: Gia v·ªã & ƒê∆∞·ªùng mu·ªëi
(104, 1017), (104, 1016), (104, 1086), (104, 1024), (104, 1064),
(104, 1082), (104, 1093), (104, 1022), (104, 1095), (104, 1025),
(104, 1042), (104, 1043), (104, 1046),

-- Category 105: Ng≈© c·ªëc & B√°nh m√¨
(105, 1010), (105, 1041), (105, 1061), (105, 1035), (105, 1023),
(105, 1030), (105, 1050), (105, 1080), (105, 1099), (105, 1074),
(105, 1049), (105, 1051), (105, 1052),

-- Category 106: S·∫£n ph·∫©m t·ª´ m·∫≠t ong & siro
(106, 1008), (106, 1022), (106, 1045), (106, 1073), (106, 1084),
(106, 1083), (106, 1092), (106, 1094), (106, 1090), (106, 1047),
(106, 1054), (106, 1057), (106, 1058), (106, 1059), (106, 1076),

-- Category 107: Th·ª±c ph·∫©m t·ª± nhi√™n & h·ªØu c∆°
(107, 1003), (107, 1004), (107, 1009), (107, 1012), (107, 1018),
(107, 1028), (107, 1036), (107, 1048), (107, 1056), (107, 1067),
(107, 1061), (107, 1062), (107, 1063), (107, 1064), (107, 1065),
(107, 1069);

-- üìä Th·ªëng k√™ t·ªìn kho theo lo·∫°i
SELECT 
    c.name AS category_name,
    SUM(p.Price) AS total_price,
    COUNT(p.Id) AS total_products
FROM 
    Category c
    JOIN Category_Product cp ON c.id = cp.ctid
    JOIN Product p ON cp.pdid = p.Id
GROUP BY 
    c.name
ORDER BY 
    total_price DESC;

